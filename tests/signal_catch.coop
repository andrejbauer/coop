(* Catch a signal arising from the body of the use block. *)

signal moo of unit ;;

use
  (cohandler unit with end) @ ()
in
  moo ()
finally
| val _ @ _ -> 1
| moo () @ _ -> 2
end ;;

(* Catch a signal arising in a co-operation. *)

operation op : unit -> unit
signal sgl of unit

let demo =
  use
    (cohandler unit with
     | op () @ () -> sgl ()
     end) @ ()
  in
    op ()
  finally
  | val _ @ _ -> 1
  | sgl () @ _ -> 2
  end

